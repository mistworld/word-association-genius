<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°ìƒì²œì¬ - IQ 140 ì—°ìƒí€´ì¦ˆ</title>
    <meta name="description" content="ë‹¹ì‹ ì€ ì²œì¬ì¸ê°€ìš”? ì‹œëƒ…ìŠ¤ê°€ ì—°ê²°ë˜ëŠ” ì§œë¦¿í•œ ì¾Œê°ì„ ëŠê»´ë³´ì„¸ìš”!">
    <meta name="theme-color" content="#6A0DAD">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a0b2e 0%, #2d1b69 100%);
            min-height: 100vh;
            color: #ffffff;
        }

        .container {
            max-width: 100%;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .start-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
        }

        .title-main {
            font-size: 2.5em;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #E040FB, #00BCD4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .start-button {
            background: linear-gradient(135deg, #9C27B0, #E040FB);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 15px 30px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .main-content {
            background: white;
            border-radius: 20px 20px 0 0;
            padding: 20px;
            flex: 1;
            margin-top: auto;
            color: #2c3e50;
        }

        .round-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .round-button {
            aspect-ratio: 1;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }

        .round-button.current {
            background: linear-gradient(135deg, #9C27B0, #E040FB);
            color: white;
        }

        .round-button.locked {
            background: #f0f0f0;
            color: #ccc;
            cursor: not-allowed;
        }

        .hint-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .answer-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            margin: 10px 0;
        }

        .submit-button {
            width: 100%;
            background: linear-gradient(135deg, #9C27B0, #E040FB);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // ê²Œì„ ìƒíƒœ ê´€ë¦¬
        let gameState = {
            currentScreen: 'start',
            currentRound: 1,
            currentProblem: 0,
            keys: 15,
            completedRounds: [],
            problems: [],
            currentProblemState: null
        };

        // ì‹œì‘ í™”ë©´
        function renderStartScreen() {
            const html = `
                <div class="container">
                    <div class="start-screen">
                        <div class="title-main">âš¡ì—°ìƒì²œì¬âš¡</div>
                        <div style="margin-bottom: 10px; color: #E040FB;">ë‡Œê°€ í„°ì§ˆ ê²ƒ ê°™ì€ ì¾Œê°</div>
                        <div style="margin-bottom: 30px; color: #00BCD4;">ë‹¹ì‹ ì€ IQ 140 ì²œì¬ì…ë‹ˆê¹Œ?</div>
                        <button class="start-button" onclick="showRoundMap()">
                            ğŸ§  ì‹œëƒ…ìŠ¤ ê°€ë™
                        </button>
                    </div>
                </div>
            `;
            document.getElementById('app').innerHTML = html;
        }

        // ë¼ìš´ë“œ ë§µ
        function showRoundMap() {
            const nextRound = gameState.completedRounds.length > 0 ? 
                Math.max(...gameState.completedRounds) + 1 : 1;
            
            const html = `
                <div class="container">
                    <div class="header">
                        <div style="color: #6A0DAD; font-weight: bold;">ì—°ìƒì²œì¬</div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="background: #FFD93D; color: #2d1b69; padding: 5px 10px; border-radius: 15px; font-weight: bold;">
                                ğŸ”‘ ${gameState.keys}
                            </div>
                        </div>
                    </div>
                    
                    <div class="main-content">
                        <h2 style="text-align: center; margin-bottom: 20px; color: #6A0DAD;">
                            ë¼ìš´ë“œ ì„ íƒ
                        </h2>
                        <div class="round-grid">
                            ${Array.from({ length: 100 }, (_, i) => {
                                const roundNumber = i + 1;
                                const isCompleted = gameState.completedRounds.includes(roundNumber);
                                const isCurrent = roundNumber === nextRound;
                                const isLocked = roundNumber > nextRound;
                                
                                return `
                                    <button 
                                        class="round-button ${isCompleted ? 'current' : isCurrent ? 'current' : isLocked ? 'locked' : 'current'}"
                                        onclick="${isLocked ? '' : `startRound(${roundNumber})`}"
                                        ${isLocked ? 'disabled' : ''}
                                    >
                                        ${roundNumber}
                                        ${isCompleted ? 'âœ…' : isCurrent ? 'â­' : isLocked ? 'ğŸ”’' : 'ğŸ¯'}
                                    </button>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('app').innerHTML = html;
            gameState.currentScreen = 'roundMap';
        }

        // ë¼ìš´ë“œ ì‹œì‘ - ê°„ë‹¨í•œ ë²„ì „
        async function startRound(roundNumber) {
            try {
                console.log(`ë¼ìš´ë“œ ${roundNumber} ì‹œì‘`);
                
                // problems_1.json íŒŒì¼ ë¡œë“œ
                const response = await fetch('problems_1.json');
                
                if (!response.ok) {
                    throw new Error('problems_1.json íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }
                
                const allProblems = await response.json();
                console.log('ì´ ë¬¸ì œ ìˆ˜:', allProblems.length);
                
                // í•´ë‹¹ ë¼ìš´ë“œ ë¬¸ì œ ì„ íƒ (ë¼ìš´ë“œë‹¹ 6ë¬¸ì œ)
                const problemsPerRound = 6;
                const startIndex = (roundNumber - 1) * problemsPerRound;
                const roundProblems = allProblems.slice(startIndex, startIndex + problemsPerRound);

                if (roundProblems.length === 0) {
                    alert('ì´ ë¼ìš´ë“œì—ëŠ” ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }
                
                gameState.currentRound = roundNumber;
                gameState.currentProblem = 0;
                gameState.problems = roundProblems;
                
                // ë¬¸ì œ ìƒíƒœ ì´ˆê¸°í™”
                gameState.currentProblemState = {
                    unlockedHints: [0, 1], // ì²˜ìŒ 2ê°œ íŒíŠ¸ í•´ê¸ˆ
                    userAnswer: '',
                    isCorrect: false
                };
                
                renderGame();
                
            } catch (error) {
                console.error('ë¼ìš´ë“œ ì‹œì‘ ì‹¤íŒ¨:', error);
                alert('ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
                showRoundMap();
            }
        }

        // ê²Œì„ í™”ë©´
        function renderGame() {
            if (!gameState.currentProblemState || gameState.problems.length === 0) {
                showRoundMap();
                return;
            }

            const problem = gameState.problems[gameState.currentProblem];
            const state = gameState.currentProblemState;

            const html = `
                <div class="container">
                    <div class="header">
                        <button onclick="showRoundMap()" style="background: #9C27B0; color: white; border: none; border-radius: 10px; padding: 8px 12px; cursor: pointer;">ğŸ </button>
                        <div style="color: #6A0DAD; font-weight: bold;">
                            ë¼ìš´ë“œ ${gameState.currentRound} - ë¬¸ì œ ${gameState.currentProblem + 1}/6
                        </div>
                        <div style="background: #FFD93D; color: #2d1b69; padding: 5px 10px; border-radius: 15px; font-weight: bold;">
                            ğŸ”‘ ${gameState.keys}
                        </div>
                    </div>
                    
                    <div class="main-content">
                        <div style="margin-bottom: 20px;">
                            ${problem.hints.map((hint, index) => {
                                const isUnlocked = state.unlockedHints.includes(index);
                                return `
                                    <div class="hint-item" style="opacity: ${isUnlocked ? '1' : '0.5'};">
                                        <div style="font-weight: bold; margin-bottom: 5px;">íŒíŠ¸ ${index + 1}</div>
                                        <div>${isUnlocked ? hint : 'ğŸ”’ ì ê¸´ íŒíŠ¸'}</div>
                                        ${!isUnlocked && index >= 2 ? `
                                            <button onclick="unlockHint(${index})" style="background: #F1948A; color: white; border: none; border-radius: 5px; padding: 5px 10px; margin-top: 5px; cursor: pointer;">
                                                ğŸ”“1 í•´ê¸ˆ
                                            </button>
                                        ` : ''}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        
                        ${!state.isCorrect ? `
                            <div>
                                <input 
                                    type="text" 
                                    class="answer-input" 
                                    placeholder="ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”"
                                    value="${state.userAnswer}"
                                    oninput="updateUserAnswer(this.value)"
                                    onkeydown="if(event.key === 'Enter') checkAnswer(this.value)"
                                />
                                <button class="submit-button" onclick="checkAnswer()">
                                    ì…ë ¥
                                </button>
                            </div>
                        ` : `
                            <div style="text-align: center; padding: 20px;">
                                <div style="font-size: 24px; margin-bottom: 10px;">ğŸ¯ ì •ë‹µ!</div>
                                <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">${problem.answer.join(', ')}</div>
                                <button class="submit-button" onclick="nextProblem()">
                                    ${gameState.currentProblem === 5 ? 'ë¼ìš´ë“œ ì™„ë£Œ' : 'ë‹¤ìŒ ë¬¸ì œ'}
                                </button>
                            </div>
                        `}
                    </div>
                </div>
            `;
            
            document.getElementById('app').innerHTML = html;
        }

        // ê²Œì„ ê¸°ëŠ¥ë“¤
        function unlockHint(hintIndex) {
            if (gameState.keys > 0) {
                gameState.keys--;
                gameState.currentProblemState.unlockedHints.push(hintIndex);
                renderGame();
            } else {
                alert('ì—´ì‡ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!');
            }
        }

        function updateUserAnswer(value) {
            gameState.currentProblemState.userAnswer = value;
        }

        function checkAnswer() {
            const problem = gameState.problems[gameState.currentProblem];
            const state = gameState.currentProblemState;
            const userAnswer = state.userAnswer.toLowerCase().replace(/\s+/g, '');
            
            const correctAnswers = problem.answer.map(ans => 
                ans.toLowerCase().replace(/\s+/g, '')
            );
            
            if (correctAnswers.includes(userAnswer)) {
                state.isCorrect = true;
                renderGame();
            } else {
                alert('í‹€ë ¸ìŠµë‹ˆë‹¤! ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.');
            }
        }

        function nextProblem() {
            if (gameState.currentProblem < 5) {
                gameState.currentProblem++;
                gameState.currentProblemState = {
                    unlockedHints: [0, 1],
                    userAnswer: '',
                    isCorrect: false
                };
                renderGame();
            } else {
                gameState.completedRounds.push(gameState.currentRound);
                gameState.keys += 1;
                alert('ë¼ìš´ë“œ ì™„ë£Œ! +1 ì—´ì‡  íšë“!');
                showRoundMap();
            }
        }

        // ì•± ì‹œì‘
        renderStartScreen();
    </script>
</body>
</html>